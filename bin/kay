#!/usr/bin/env ruby

require 'kay'
require 'colorize'

command = ARGV[0]

include Kay

begin
  if command == 'create'
    options = CreateParse.parse(ARGV)
    Create.new(options.name).run
  elsif command == 'register'
    options = RegisterParse.parse(ARGV)
    Register.new(options.host).run
  elsif command == 'key-add'
    options = KeyAddParse.parse(ARGV)
    KeyAdd.new(options.file, options.name).run
  elsif command == 'branch-add'
    options = BranchAddParse.parse(ARGV)
    BranchAdd.new(options.branch).run
  elsif command == 'branch-remove'
    options = BranchRemoveParse.parse(ARGV)
    BranchRemove.new(options.branch).run
  elsif command == 'env-add'
    options = EnvAddParse.parse(ARGV)
    EnvAdd.new(options.branch, options).run
  elsif command == 'login'
    options = LoginParse.parse(ARGV)
    Login.new(options.host).run
  elsif command == 'join'
    options = JoinParse.parse(ARGV)
    Join.new(options.proj_id).run
  elsif command == 'scale'
    options = ScaleParse.parse(ARGV)
    Scale.new(options.branch, options.app, options.instances).run
  end
rescue SystemExit => e
  exit
rescue Exception => e
  abort(e.message.red)
end
